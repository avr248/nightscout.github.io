<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Nightscout in Fly.io &mdash; Nightscout Documentation  documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/custom.css" type="text/css" />
    <link rel="shortcut icon" href="../../../_static/NS-logo.png"/>
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/sphinx_highlight.js"></script>
        <script src="../../../_static/design-tabs.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex/" />
    <link rel="search" title="Search" href="../../../search/" />
    <link rel="next" title="Setup your Profile" href="../../../nightscout/profile_editor/" />
    <link rel="prev" title="Nightscout in Heroku" href="../../heroku/new_user/" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../../" class="icon icon-home">
            Nightscout Documentation
              <img src="../../../_static/we are not waiting vertical.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search/" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../../uploader/uploaders/">Supported Uploaders</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CREATE YOUR NIGHTSCOUT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/new_user/">New Nightscout Users</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/wizard/">Help me choose</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CREATE YOUR DATABASE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/database/">Choose your database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../mongodb/atlas/">MongoDB Atlas Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../railway/database/">Railway Database</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../northflank/database/">Northflank Database</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">CREATE YOUR WEB APP</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/platform/">Choose your platform</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../azure/new_user/">Nightscout in Azure (Docker)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../northflank/new_user/">Nightscout in Northflank</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../render/new_user/">Nightscout in Render</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../railway/new_user/">Nightscout in Railway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heroku/new_user/">Nightscout in Heroku</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Nightscout in Fly.io</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#step-0-create-a-database">Step 0: Create a database</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-1-create-a-github-account-and-fork-the-nightscout-project">Step 1: Create a GitHub account and fork the Nightscout project</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-2-download-fly-io-command-line-interface-cli">Step 2: Download fly.io Command Line Interface (CLI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-3-create-a-fly-io-account">Step 3: Create a fly.io account</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-4-locally-fork-and-deploy-cgm-remote-monitor">Step 4: Locally fork and deploy cgm-remote-monitor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#step-5-setting-variables">Step 5: Setting Variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="#new-nightscout-setup">New Nightscout Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#editing-config-vars-in-fly-io">Editing Config Vars in Fly.io</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#env-variables">Env variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#secrets">Secrets</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SETUP NIGHTSCOUT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/profile_editor/">Setup your Profile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../uploader/setup/">Setup Uploaders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/downloaders/">Setup Downloaders - Followers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/wearable/">Nightscout on your Watch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/setup_variables/">Nightscout Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../uploader/xdripcarelink/">xDrip+ for CareLink</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/dexcom_bridge/">Troubleshoot Dexcom Share</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">USE NIGHTSCOUT</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/discover/">Discover your Nightscout site</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/reports/">Create Reports</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/security/">Nightscout Security and Privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/admin_tools/">Admin Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/close_loop/">Closed loop systems</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/ifttt/">IFTTT Integration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/pushover/">Remote notifications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/troubleshoot/">Troubleshooting Nightscout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../update/update/">Update Nightscout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../update/dev_branch/">Deploy another version</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../update/downgrade/">Downgrade Nightscout</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">ADVANCED DIY</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/advanced/">Advanced Nightscout deployments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VPS/ubuntu/">Building Nightscout in Ubuntu</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../VPS/docker/">Building Nightscout with Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../NAS/synology/">Nightscout in your Synology NAS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">VENDORS</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/multiadmin/">Multiple sites and support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../github/update/">Update GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../update/redeploy/">Redeploy with GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/github/">Troubleshoot GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/atlas/">Troubleshoot MongoDB Atlas</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/azure/">Troubleshoot Azure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/heroku/">Troubleshoot Heroku</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heroku/migrate/">Migration?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heroku/ecoplan/">Heroku Eco plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heroku/hobbyplan/">Heroku Basic plan</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../heroku/mfa/">Heroku MFA</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../update/upd_stack/">Update the Heroku stack</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/railway/">Troubleshoot Railway</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/fly.io/">Troubleshoot Fly.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../troubleshoot/render/">Troubleshoot Render</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../nightscout/dns/">Use a Dynamic DNS</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">TRANSLATE</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../translate/">Google Translate links</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../">Nightscout Documentation</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Nightscout in Fly.io</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/vendors/fly.io/new_user.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="nightscout-in-fly-io">
<h1>Nightscout in Fly.io<a class="headerlink" href="#nightscout-in-fly-io" title="Permalink to this heading"></a></h1>
</br>
<div class="seealso admonition">
<p class="admonition-title">Too complicated? Not what you’re looking for?</p>
<p>Consider a hosted Nightscout service! Check for easier solutions <a class="reference internal" href="../../../#nightscout-as-a-service"><span class="std std-ref">here</span></a>.</p>
</div>
</br>
<div class="sd-card sd-sphinx-override sd-mb-3 sd-shadow-sm docutils">
<div class="sd-card-header docutils">
<h2 class="rubric" id="fly-io">Fly.io</h2>
<p class="sd-card-text"><img alt="Fly.io" src="../../../_images/Fly.io.png" /></p>
</div>
<div class="sd-card-body docutils">
<p class="sd-card-text">Fly.io proposes a <a class="reference internal" href="../migrate/"><span class="std std-doc">simple migration wizard from Heroku</span></a> and you can create your new Nightscout site in Fly.io. Using a computer is mandatory with Fly.io as managing your site will require the use of a command line utility. <strong>Not recommended for beginners.</strong></p>
<p class="sd-card-text"><strong>Pros</strong>:</p>
<ul class="simple">
<li><p class="sd-card-text">Nightscout fits in the free tier</p></li>
<li><p class="sd-card-text">Easy to migrate an existing site from Heroku</p></li>
</ul>
<p class="sd-card-text"><strong>Cons</strong>:</p>
<ul class="simple">
<li><p class="sd-card-text"><strong>Maintaining your site requires the use of a computer with command line instructions, not very intuitive</strong></p></li>
<li><p class="sd-card-text">Migrated Heroku sites store variables as secrets</p></li>
<li><p class="sd-card-text">Relying on the MongoDB Atlas database</p></li>
</ul>
</div>
</div>
</br>
<section id="step-0-create-a-database">
<h2>Step 0: Create a database<a class="headerlink" href="#step-0-create-a-database" title="Permalink to this heading"></a></h2>
<div class="note admonition">
<p class="admonition-title">Fly.io doesn’t include a database</p>
<p>Make sure you <a class="reference internal" href="../../../nightscout/database/"><span class="doc std std-doc">created one</span></a> before starting your Nightscout web app creation with Fly.io.
Come back here when you have a <code class="docutils literal notranslate"><span class="pre">MONGODB_URI</span></code> connection string.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Migrating?</p>
<p>Copy the connection string from your previous platform: <a class="reference internal" href="../../../nightscout/setup_variables/#nightscout-configuration"><span class="std std-ref">edit the variables</span></a> and look for <code class="docutils literal notranslate"><span class="pre">MONGODB_URI</span></code>.
If you don’t see <code class="docutils literal notranslate"><span class="pre">MONGODB_URI</span></code> but see <code class="docutils literal notranslate"><span class="pre">MONGO_CONNECTION</span></code> (<strong>NOT</strong> <code class="docutils literal notranslate"><span class="pre">MONGO_COLLECTION</span></code>): use its value.</p>
</div>
</br>
</section>
<section id="step-1-create-a-github-account-and-fork-the-nightscout-project">
<h2>Step 1: Create a GitHub account and fork the Nightscout project<a class="headerlink" href="#step-1-create-a-github-account-and-fork-the-nightscout-project" title="Permalink to this heading"></a></h2>
<div class="sd-tab-set docutils">
<input checked="checked" id="sd-tab-item-0" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-0">
I don’t have a GitHub Account</label><div class="sd-tab-content docutils">
<h3 class="rubric" id="create-a-github-account">Create a GitHub account</h3>
<p>a) Click this link to create a GitHub account: <a class="reference external" href="https://github.com/">https://github.com/</a></p>
<p>Enter your email and click <code class="docutils literal notranslate"><span class="pre">Sign</span> <span class="pre">up</span> <span class="pre">for</span> <span class="pre">GitHub</span></code></br></p>
<p><a class="reference internal" href="../../../_images/NewNS00a.png"><img alt="../../../_images/NewNS00a.png" src="../../../_images/NewNS00a.png" style="width: 600px;" /></a></br></p>
<p>b) Enter a password and a username (anything you want and that is accepted, not very important).<br />
Type <code class="docutils literal notranslate"><span class="pre">n</span></code> to decline advertisement emails.</br></p>
<p><a class="reference internal" href="../../../_images/NewNS00.png"><img alt="../../../_images/NewNS00.png" src="../../../_images/NewNS00.png" style="width: 500px;" /></a></br></p>
<p>c) Play and solve the puzzle then click <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">account</span></code></br></p>
<p><a class="reference internal" href="../../../_images/NewNS01.png"><img alt="../../../_images/NewNS01.png" src="../../../_images/NewNS01.png" style="width: 500px;" /></a></br></p>
<p>d)  GitHub will send you a verification code. Open your mail and check your inbox (check your spam-folder if not received after a couple of minutes).</br></p>
<p><a class="reference internal" href="../../../_images/NewNS02.png"><img alt="../../../_images/NewNS02.png" src="../../../_images/NewNS02.png" style="width: 500px;" /></a></br></p>
<p>e) If a personalization sequence starts, click <code class="docutils literal notranslate"><span class="pre">Skip</span> <span class="pre">personalization</span> </code> at the bottom.</br></p>
<p><a class="reference internal" href="../../../_images/NewNS03.png"><img alt="../../../_images/NewNS03.png" src="../../../_images/NewNS03.png" style="width: 600px;" /></a></br></p>
<p>f) Leave the page that opened as it is. Don’t close it.</br></p>
<p><a class="reference internal" href="../../../_images/NewNS04.png"><img alt="../../../_images/NewNS04.png" src="../../../_images/NewNS04.png" style="width: 600px;" /></a></br></p>
<p>You have created your GitHub account.</br></p>
</div>
<input id="sd-tab-item-1" name="sd-tab-set-0" type="radio">
</input><label class="sd-tab-label" for="sd-tab-item-1">
I already have a GitHub Account</label><div class="sd-tab-content docutils">
<h3 class="rubric" id="update-your-nightscout-fork">Update your Nightscout fork</h3>
<ul class="simple">
<li><p>Click here to log in at GitHub: <a class="reference external" href="https://github.com/login">https://github.com/login</a>.</p></li>
<li><p>Enter your username or email and your password. Click <code class="docutils literal notranslate"><span class="pre">Sign</span> <span class="pre">in</span></code></br></p></li>
</ul>
<p><a class="reference internal" href="../../../_images/UpdateNS00.png"><img alt="../../../_images/UpdateNS00.png" src="../../../_images/UpdateNS00.png" style="width: 400px;" /></a></br></p>
<ul class="simple">
<li><p>Select your own <code class="docutils literal notranslate"><span class="pre">cgm-remote-monitor</span></code> project (<strong>not <code class="docutils literal notranslate"><span class="pre">nightscout/cgm-remote-monitor</span></code></strong>)</br></p></li>
</ul>
<p><a class="reference internal" href="../../../_images/UpdateNS01.png"><img alt="../../../_images/UpdateNS01.png" src="../../../_images/UpdateNS01.png" style="width: 400px;" /></a></br></p>
<ul class="simple">
<li><p>Your repository will open. If you see <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">branch</span> <span class="pre">is</span> <span class="pre">xxx</span> <span class="pre">commits</span> <span class="pre">behind</span> <span class="pre">nightscout:master</span></code> you need to update.</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Fetch</span> <span class="pre">upstream</span></code></br></p></li>
</ul>
<p><a class="reference internal" href="../../../_images/UpdateNS01a.png"><img alt="../../../_images/UpdateNS01a.png" src="../../../_images/UpdateNS01a.png" style="width: 700px;" /></a></br></p>
<ul class="simple">
<li><p>Select <code class="docutils literal notranslate"><span class="pre">Fetch</span> <span class="pre">and</span> <span class="pre">merge</span></code></br></p></li>
</ul>
<p><a class="reference internal" href="../../../_images/UpdateNS01b.png"><img alt="../../../_images/UpdateNS01b.png" src="../../../_images/UpdateNS01b.png" style="width: 400px;" /></a></br></p>
<ul class="simple">
<li><p>After a moment, your repository should display <code class="docutils literal notranslate"><span class="pre">This</span> <span class="pre">branch</span> <span class="pre">is</span> <span class="pre">up</span> <span class="pre">to</span> <span class="pre">date</span> <span class="pre">with</span> <span class="pre">nightscout:master</span></code></br></p></li>
</ul>
<p><a class="reference internal" href="../../../_images/UpdateNS01c.png"><img alt="../../../_images/UpdateNS01c.png" src="../../../_images/UpdateNS01c.png" style="width: 400px;" /></a></br></p>
<p>You have now updated your GitHub cgm-remote-monitor repository.</p>
</br>
<p>If you ran into trouble, you can <a class="reference internal" href="../../../update/redeploy/"><span class="doc std std-doc">redeploy</span></a> the project.</p>
</br>
</div>
</div>
</br>
</section>
<section id="step-2-download-fly-io-command-line-interface-cli">
<h2>Step 2: Download fly.io Command Line Interface (CLI)<a class="headerlink" href="#step-2-download-fly-io-command-line-interface-cli" title="Permalink to this heading"></a></h2>
<p>Fly.io is mainly managed through a command line interface (CLI). The first step will be installing the CLI <a class="reference external" href="https://fly.io/docs/flyctl/installing/">which is documented here</a>.</p>
<br>
</section>
<section id="step-3-create-a-fly-io-account">
<h2>Step 3: Create a fly.io account<a class="headerlink" href="#step-3-create-a-fly-io-account" title="Permalink to this heading"></a></h2>
<p>a) <code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">auth</span> <span class="pre">signup</span></code> will begin the signup process, alternatively go to <a class="reference external" href="https://fly.io/app/sign-up">https://fly.io/app/sign-up</a> to login.<br />
Sign up with Github.</p>
</br>
<p>b) <code class="docutils literal notranslate"><span class="pre">Authorize</span> <span class="pre">Fly.io</span></code> for GitHub:</p>
<a class="reference internal image-reference" href="../../../_images/FlyIOA3.png"><img alt="../../../_images/FlyIOA3.png" src="../../../_images/FlyIOA3.png" style="width: 400px;" /></a>
</br>
<p>c) You don’t need to input card information to get Nightscout running so click the <code class="docutils literal notranslate"><span class="pre">Try</span> <span class="pre">fly.io</span> <span class="pre">for</span> <span class="pre">free</span></code> button:</p>
<a class="reference internal image-reference" href="../../../_images/FlyIOA1.png"><img alt="../../../_images/FlyIOA1.png" src="../../../_images/FlyIOA1.png" style="width: 400px;" /></a>
<p></br></br></p>
</section>
<section id="step-4-locally-fork-and-deploy-cgm-remote-monitor">
<h2>Step 4: Locally fork and deploy cgm-remote-monitor<a class="headerlink" href="#step-4-locally-fork-and-deploy-cgm-remote-monitor" title="Permalink to this heading"></a></h2>
<p>a) Clone the <code class="docutils literal notranslate"><span class="pre">cgm-remote-monitor</span></code> repository locally:</p>
<p>If necessary install <a class="reference external" href="https://git-scm.com/downloads">Git</a> on your computer (pick your own OS in Downloads).</p>
<p>Open a PowerShell (Windows) or a terminal (OSX/Linux), and type (replace <code class="docutils literal notranslate"><span class="pre">yourGitHubNameHere</span></code> by your own GitHub account name):</p>
<p><code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">https://github.com/yourGitHubNameHere/cgm-remote-monitor</span></code></p>
<a class="reference internal image-reference" href="../../../_images/FlyIO01.png"><img alt="../../../_images/FlyIO01.png" src="../../../_images/FlyIO01.png" style="width: 600px;" /></a>
</br>
<p>b) Navigate to the directory where you code has been cloned locally</p>
<p><code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">cgm-remote-monitor</span></code></p>
</br>
<p>c) Download this <a class="reference download internal" download="" href="../../../_downloads/6afed6d2f32efe776c4cacc1a6f6a3f8/fly.toml"><span class="xref download myst"><strong>fly.toml template</strong></span></a> deployment file and save it/copy it into your <code class="docutils literal notranslate"><span class="pre">cgm-remote-monitor</span></code> folder.</p>
</br>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Do NOT sync your local fly,toml with GitHub to avoid exposing all your passwords on GitHub!!!</p>
</div>
</br>
</section>
<section id="step-5-setting-variables">
<h2>Step 5: Setting Variables<a class="headerlink" href="#step-5-setting-variables" title="Permalink to this heading"></a></h2>
<p>Open the <code class="docutils literal notranslate"><span class="pre">fly.toml</span></code> configuration file in your <code class="docutils literal notranslate"><span class="pre">cgm-remote-monitor</span></code> folder and customize it.</p>
<p>a) <code class="docutils literal notranslate"><span class="pre">API_SECRET</span></code> will be your Nightscout site password, it needs to be at least 12 characters long and you should <strong>NOT use spaces</strong> if you use &#64; or ! symbols remember you will probably need to express them using <a class="reference external" href="https://en.wikipedia.org/wiki/Percent-encoding#Percent-encoding_reserved_characters">Percent encoding</a> in your uploader and downloader apps. If you’re not sure on how to do this, it is recommended to use only letters (uppercase + lowercase) and digits.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The API_SECRET is the <strong>main password allowing full access to your Nightscout site</strong>. Make sure it’s reasonably secure (mix uppercase and lowercase letters, plus digits) and <strong>do no not share it publicly</strong>. If you think you exposed it by mistake, it is recommended that you <strong>change it</strong>.</p>
</div>
</br>
<p>b) Set the units to use for Nightscout where acceptable choices are <code class="docutils literal notranslate"><span class="pre">mg/dl</span></code> or <code class="docutils literal notranslate"><span class="pre">mmol/L</span></code> (or just <code class="docutils literal notranslate"><span class="pre">mmol</span></code>).</p>
</br>
<p>c) Now you need the connection string you defined during the Atlas cluster creation (as the example below, but not the string below).</p>
<p>Make sure it looks like this one below and NOTE: THERE ARE NO &lt; AND &gt; CHARACTERS:</p>
<p>Example for MongoDB Atlas:</p>
<p><code class="docutils literal notranslate"><span class="pre">mongodb+srv://nightscout:soo5ecret&#64;cluster0.xxxxx.mongodb.net/?retryWrites=true&amp;w=majority</span></code></p>
<p>Example for a MongoDB database:</p>
<p><code class="docutils literal notranslate"><span class="pre">mongodb://nightscout:soo5ecret&#64;mydbhosting.fqd/mydatabase</span></code></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Ensure you have <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code> surrounding your URI to make sure all of it is captured within the variable.</p>
</div>
</br>
<p>d) If you want to link your Dexcom Share account as a data source, complete the following lines: <code class="docutils literal notranslate"><span class="pre">BRIDGE_USER_NAME</span></code>, <code class="docutils literal notranslate"><span class="pre">BRIDGE_PASSWORD</span></code> and <code class="docutils literal notranslate"><span class="pre">BRIDGE_SERVER</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you use a DIY closed loop system it is recommended that you let it upload to Nightscout instead of importing using Dexcom Share and the <code class="docutils literal notranslate"><span class="pre">bridge</span></code> plugin.</p>
</div>
</br>
<div class="hint admonition">
<p class="admonition-title">MOST COMMON ERRORS</p>
<p>The most common error on initial Nightscout setups is that people incorrectly use an old account or an old password. To test your username and password, go to Dexcom’s Clarity page (check <a class="reference external" href="https://clarity.dexcom.com">here for USA accounts</a> and <a class="reference external" href="https://clarity.dexcom.eu">here for the others</a>) and try logging in to your Dexcom account. If your account info isn’t valid, or you don’t see any data in your Clarity account… you need to figure out your actual credentials before moving ahead. See <a class="reference internal" href="../../../troubleshoot/dexcom_bridge/"><span class="doc std std-doc">here</span></a> for troubleshooting tips and information on your Dexcom account.</p>
</div>
<div class="note admonition">
<p class="admonition-title">Password</p>
<p><em>Some people have had problems with their bridge connecting when their Dexcom passwords are entirely numeric. If you have connection issues in that case, try changing your password to something with a mix of numbers and letters.</em></p>
</div>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>You need to have at least one follower to use Dexcom Share. See <a class="reference internal" href="../../../uploader/setup/#dexcom"><span class="std std-ref">here</span></a>.</p>
</div>
 </br>
<p>e) In <a class="reference internal" href="../../../nightscout/setup_variables/#enable"><span class="std std-ref"><code class="docutils literal notranslate"><span class="pre">ENABLE</span></code></span></a>, copy and paste the following words (separated by a space) so that won’t have to think about which you want now:</p>
<p><code class="docutils literal notranslate"><span class="pre">careportal</span> <span class="pre">basal</span> <span class="pre">dbsize</span> <span class="pre">rawbg</span> <span class="pre">iob</span> <span class="pre">maker</span> <span class="pre">cob</span> <span class="pre">bwp</span> <span class="pre">cage</span> <span class="pre">iage</span> <span class="pre">sage</span> <span class="pre">boluscalc</span> <span class="pre">pushover</span> <span class="pre">treatmentnotify</span> <span class="pre">loop</span> <span class="pre">pump</span> <span class="pre">profile</span> <span class="pre">food</span> <span class="pre">openaps</span> <span class="pre">bage</span> <span class="pre">alexa</span> <span class="pre">override</span> <span class="pre">speech</span> <span class="pre">cors</span></code></p>
<p><strong>If you are using your Dexcom share account as a data source</strong> also add <code class="docutils literal notranslate"><span class="pre">bridge</span></code> at the end, after a space like this:</p>
<p><code class="docutils literal notranslate"><span class="pre">careportal</span> <span class="pre">basal</span> <span class="pre">dbsize</span> <span class="pre">rawbg</span> <span class="pre">iob</span> <span class="pre">maker</span> <span class="pre">cob</span> <span class="pre">bwp</span> <span class="pre">cage</span> <span class="pre">iage</span> <span class="pre">sage</span> <span class="pre">boluscalc</span> <span class="pre">pushover</span> <span class="pre">treatmentnotify</span> <span class="pre">loop</span> <span class="pre">pump</span> <span class="pre">profile</span> <span class="pre">food</span> <span class="pre">openaps</span> <span class="pre">bage</span> <span class="pre">alexa</span> <span class="pre">override</span> <span class="pre">speech</span> <span class="pre">cors</span> <span class="pre">bridge</span></code></p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p>Ensure you have <code class="docutils literal notranslate"><span class="pre">&quot;</span> <span class="pre">&quot;</span></code> surrounding your words to make sure all of them are captured within the variable.</p>
</div>
</br>
<p>f) You can customize other variables or leave default values.</p>
</br>
<p>g) You can now deploy your site with Fly.io.<br />
Type the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">launch</span></code></p>
</br>
<p>To the question <code class="docutils literal notranslate"><span class="pre">Would</span> <span class="pre">you</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">copy</span> <span class="pre">its</span> <span class="pre">configuration</span> <span class="pre">to</span> <span class="pre">the</span> <span class="pre">new</span> <span class="pre">app?</span></code> answer <code class="docutils literal notranslate"><span class="pre">Y</span></code> (yes).</p>
<p>To the question: <code class="docutils literal notranslate"><span class="pre">App</span> <span class="pre">Name</span> <span class="pre">(leave</span> <span class="pre">blank</span> <span class="pre">to</span> <span class="pre">use</span> <span class="pre">an</span> <span class="pre">auto-generated</span> <span class="pre">name):</span></code> answer with the same same you’ve put in the <code class="docutils literal notranslate"><span class="pre">fly.toml</span></code> file in the top line <code class="docutils literal notranslate"><span class="pre">app</span> <span class="pre">=</span> <span class="pre">&quot;&quot;</span></code>.</p>
<p>To the question  <code class="docutils literal notranslate"><span class="pre">Select</span> <span class="pre">region:</span> </code> select the region closer to where you live (using the up and down arrows).</p>
<a class="reference internal image-reference" href="../../../_images/FlyIO03.png"><img alt="../../../_images/FlyIO03.png" src="../../../_images/FlyIO03.png" style="width: 600px;" /></a>
<p>To the question <code class="docutils literal notranslate"><span class="pre">Would</span> <span class="pre">you</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">set</span> <span class="pre">up</span> <span class="pre">an</span> <span class="pre">Postgresql</span> <span class="pre">database</span> <span class="pre">now?</span></code> answer <code class="docutils literal notranslate"><span class="pre">N</span></code> (no).</p>
<p>To the question <code class="docutils literal notranslate"><span class="pre">Would</span> <span class="pre">you</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">set</span> <span class="pre">up</span> <span class="pre">an</span> <span class="pre">Upstash</span> <span class="pre">Redis</span> <span class="pre">database</span> <span class="pre">now?</span></code> answer <code class="docutils literal notranslate"><span class="pre">N</span></code> (no).</p>
<p>To the question <code class="docutils literal notranslate"><span class="pre">Would</span> <span class="pre">you</span> <span class="pre">like</span> <span class="pre">to</span> <span class="pre">deploy</span> <span class="pre">now?</span></code> answer <code class="docutils literal notranslate"><span class="pre">Y</span></code> (yes).</p>
<a class="reference internal image-reference" href="../../../_images/FlyIO02.png"><img alt="../../../_images/FlyIO02.png" src="../../../_images/FlyIO02.png" style="width: 600px;" /></a>
</br>
<p>Deploy will take some time. Do not interrupt the process.</p>
<a class="reference internal image-reference" href="../../../_images/FlyIO04.png"><img alt="../../../_images/FlyIO04.png" src="../../../_images/FlyIO04.png" style="width: 600px;" /></a>
</br>
<p>If you see the following text:</p>
<p><code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">desired,</span> <span class="pre">1</span> <span class="pre">placed,</span> <span class="pre">1</span> <span class="pre">healthy,</span> <span class="pre">0</span> <span class="pre">unhealthy</span> <span class="pre">[health</span> <span class="pre">checks:</span> <span class="pre">1</span> <span class="pre">total,</span> <span class="pre">1</span> <span class="pre">passing]</span></code></p>
<p>You have successfully deployed Nightscout in Fly.io. Congratulations.</p>
<p>If you see an unhealthy condition, check your <code class="docutils literal notranslate"><span class="pre">fly.toml</span></code> configuration (for missing ” ” for example) and type:</p>
<p><code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">deploy</span></code></p>
</br>
<p>h) Once your site has processed the variables and redeployed itself it will be ready to use. In your fly.io dashboard at <a class="reference external" href="https://fly.io/dashboard">https://fly.io/dashboard</a> click on the application (not the builder):</p>
<a class="reference internal image-reference" href="../../../_images/FlyIOA2.png"><img alt="../../../_images/FlyIOA2.png" src="../../../_images/FlyIOA2.png" style="width: 700px;" /></a>
</br>
<p>i) Inside your app you should see that it is running and has a clickable hostname.</p>
<a class="reference internal image-reference" href="../../../_images/FlyIO05.png"><img alt="../../../_images/FlyIO05.png" src="../../../_images/FlyIO05.png" style="width: 500px;" /></a>
</br>
<p>j) Recent versions of flyctl will make the app high availability (2 machines) by default, and this might generate problems for Nightscout.<br />
Make sure to downscale your app with the following command (replace <em><strong><code class="docutils literal notranslate"><span class="pre">app_name</span></code></strong></em> with your own app name):</p>
<p><code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">scale</span> <span class="pre">--app</span> </code><em><strong><code class="docutils literal notranslate"><span class="pre">app_name</span></code></strong></em><code class="docutils literal notranslate"> <span class="pre">count</span> <span class="pre">1</span></code></p>
</br>
</section>
<section id="new-nightscout-setup">
<h2>New Nightscout Setup<a class="headerlink" href="#new-nightscout-setup" title="Permalink to this heading"></a></h2>
</br>
<p>a) Your Nightscout site should open and direct you to a new profile creation.</p>
<a class="reference internal image-reference" href="../../../_images/NewNS50.png"><img alt="../../../_images/NewNS50.png" src="../../../_images/NewNS50.png" style="width: 400px;" /></a>
</br>
<p>b) Setup your <code class="docutils literal notranslate"><span class="pre">Time</span> <span class="pre">zone</span></code> and eventually all other fields. Do not leave any fields empty. If you don’t know which value to use, just use the default value. You can change these values later at any time.</p>
<a class="reference internal image-reference" href="../../../_images/NewNS44.png"><img alt="../../../_images/NewNS44.png" src="../../../_images/NewNS44.png" style="width: 500px;" /></a>
</br>
<p>c) Browse down to <code class="docutils literal notranslate"><span class="pre">Authentication</span> <span class="pre">status</span></code> and click <code class="docutils literal notranslate"><span class="pre">Authenticate</span></code>. Enter your API secret. Click <code class="docutils literal notranslate"><span class="pre">Update</span></code>.</p>
<a class="reference internal image-reference" href="../../../_images/NewNS45.png"><img alt="../../../_images/NewNS45.png" src="../../../_images/NewNS45.png" style="width: 500px;" /></a>
</br>
<p>d) Click <code class="docutils literal notranslate"><span class="pre">Save</span></code>.</p>
<a class="reference internal image-reference" href="../../../_images/NewNS46.png"><img alt="../../../_images/NewNS46.png" src="../../../_images/NewNS46.png" style="width: 200px;" /></a>
</br>
<p>e) If the following pop-up shows up click <code class="docutils literal notranslate"><span class="pre">OK</span></code>, and check status (upper right of the window).</p>
<a class="reference internal image-reference" href="../../../_images/NewNS47.png"><img alt="../../../_images/NewNS47.png" src="../../../_images/NewNS47.png" style="width: 600px;" /></a>
</br>
<p>f) If you need to modify your profile after this, authenticate with the lock icon (top right of the page): enter your API secret. Then click on the hamburger menu and select <code class="docutils literal notranslate"><span class="pre">Profile</span> <span class="pre">Editor</span></code>.</p>
<a class="reference internal image-reference" href="../../../_images/NewNS43.png"><img alt="../../../_images/NewNS43.png" src="../../../_images/NewNS43.png" style="width: 600px;" /></a>
</br>
<div class="warning admonition">
<p class="admonition-title">Privacy warning</p>
<p>Anyone with access to the URL of your Nightscout site, can view your BG and run reports of your data. It it strongly recommended that you enable <a class="reference internal" href="../../../nightscout/security/"><span class="doc std std-doc">security</span></a> to your site once you’re done with the setup</p>
</div>
</br>
<p>g) Dexcom Share users should see data flowing in after some minutes.
xDrip+ users (including Medtronic <a class="reference internal" href="../../../uploader/setup/#medtronic-carelink"><span class="std std-ref">CareLink followers</span></a>) should setup the uploader as shown <a class="reference internal" href="../../../uploader/setup/#xdrip"><span class="std std-ref"><strong>here</strong></span></a>.
xDrip4iOS users <a class="reference external" href="https://xdrip4ios.readthedocs.io/en/latest/connect/cgm/#nightscout-upload">here</a>.
<a class="reference external" href="https://androidaps.readthedocs.io/en/latest/Configuration/Preferences.html#nsclient">AAPS</a> and <a class="reference external" href="https://loopkit.github.io/loopdocs/operation/loop-settings/services/">Loop</a>: consult the relative documentation.</p>
<a class="reference internal image-reference" href="../../../_images/NewNS48.png"><img alt="../../../_images/NewNS48.png" src="../../../_images/NewNS48.png" style="width: 600px;" /></a>
</br>
<hr class="docutils" />
<p>You have completed a new Nightscout site creation. You can continue <a class="reference internal" href="../../../nightscout/discover/"><span class="doc std std-doc">here</span></a> now.</p>
<p>The following section provides more information that you might not need to use now.</p>
<hr class="docutils" />
</br>
</br>
<!-- Somhow this natural anchor link doesn't work -->
</section>
<section id="editing-config-vars-in-fly-io">
<h2>Editing Config Vars in Fly.io<a class="headerlink" href="#editing-config-vars-in-fly-io" title="Permalink to this heading"></a></h2>
</br>
<p>You will find your Nightscout variables under different forms depending on your deployment method.</p>
<p>If you migrated using the wizard, they will be secrets.</p>
<p>If you deployed a new site as explained in this documentation they will be environment variables.</p>
</br>
<section id="env-variables">
<h3>Env variables<a class="headerlink" href="#env-variables" title="Permalink to this heading"></a></h3>
<p>Environment variables can be viewed with <a class="reference external" href="https://fly.io/docs/hands-on/install-flyctl">flyctl</a> using the following command:</p>
<p><code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">config</span> <span class="pre">env</span></code></p>
<p>If you want to modify a configuration variable you need to edit the <code class="docutils literal notranslate"><span class="pre">fly.toml</span></code> file in your local <code class="docutils literal notranslate"><span class="pre">cgm-remote-monitor</span></code> copy (the one you created at <a class="reference internal" href="#step-5-setting-variables">step 5</a> above).</p>
<p>Once variable(s) modified, save the file and run the following command (from inside your <code class="docutils literal notranslate"><span class="pre">cgm-remote-monitor</span></code>).</p>
<p><code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">deploy</span></code></p>
</br>
</section>
<section id="secrets">
<h3>Secrets<a class="headerlink" href="#secrets" title="Permalink to this heading"></a></h3>
<p>Your variables are stored as secrets if you used the migration wizard.</p>
<div class="warning admonition">
<p class="admonition-title">Secrets</p>
<p>You <strong>cannot see the values of your secret variables as they are secret</strong>.
You can only delete them and set them: you <strong>cannot edit them</strong>.
Please make sure you write them down somewhere!</p>
</div>
</br>
<p><strong>Once Nightscout deployed, you need to install <a class="reference external" href="https://fly.io/docs/hands-on/install-flyctl/">flyctl</a> to access your variables in order to change or customize your site.</strong>
Variables are described <a class="reference internal" href="../../../nightscout/setup_variables/#nightscout-config-vars"><span class="std std-ref">here</span></a>.</p>
<p><a class="reference external" href="https://fly.io/docs/hands-on/sign-in/">Sign in with GitHub</a> in your CLI interface (Powershell/Terminal).<br />
A new browser will open. Select the entry with your email address.<br />
If required, authenticate through GitHub.</p>
<img alt="../../../_images/FlyM16.png" src="../../../_images/FlyM16.png" />
</br>
<p>Fly.io variables are named <code class="docutils literal notranslate"><span class="pre">Secrets</span></code> and you cannot visualize them.<br />
Look <a class="reference external" href="https://fly.io/docs/getting-started/working-with-fly-apps/#working-with-secrets">here</a> for more details.</p>
</br>
<p>If you want to create a new variable or modify an existing one you need to use the <code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">secrets</span> <span class="pre">set</span></code> command.<br />
For example if you want to set your Nightscout site vertical scale to linear:</p>
<p><code class="docutils literal notranslate"><span class="pre">flyctl</span> <span class="pre">secrets</span> <span class="pre">set</span> <span class="pre">SCALE_Y=&quot;linear&quot;</span> <span class="pre">-a</span> <span class="pre">yourappname</span></code></p>
<p>If your <code class="docutils literal notranslate"><span class="pre">SCALE_Y</span></code> variable was already set to <code class="docutils literal notranslate"><span class="pre">linear</span></code> you will see the following message:<br />
<code class="docutils literal notranslate"><span class="pre">Error</span> <span class="pre">No</span> <span class="pre">change</span> <span class="pre">detected</span> <span class="pre">to</span> <span class="pre">secrets.</span> <span class="pre">Skipping</span> <span class="pre">release.</span></code></p>
<p>When changing a variable, the app will automatically redeploy. You will see this sequence (it will take a few minutes):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Release</span> <span class="n">v1</span> <span class="n">created</span>
<span class="o">==&gt;</span> <span class="n">Monitoring</span> <span class="n">deployment</span>

 <span class="mi">1</span> <span class="n">desired</span><span class="p">,</span> <span class="mi">1</span> <span class="n">placed</span><span class="p">,</span> <span class="mi">1</span> <span class="n">healthy</span><span class="p">,</span> <span class="mi">0</span> <span class="n">unhealthy</span> <span class="p">[</span><span class="n">health</span> <span class="n">checks</span><span class="p">:</span> <span class="mi">1</span> <span class="n">total</span><span class="p">,</span> <span class="mi">1</span> <span class="n">passing</span><span class="p">]</span>
<span class="o">--&gt;</span> <span class="n">v1</span> <span class="n">deployed</span> <span class="n">successfully</span>
</pre></div>
</div>
</br>
</section>
</section>
</section>


           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, #WeAreNotWaiting.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>